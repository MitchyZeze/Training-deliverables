# タスク・工数管理シート マクロ作成定義

## 作成意図

タスク・スケジュール管理が不十分で、業務指示者との間で認識ズレが発生し、業務に支障が生じたことから、自分なりの管理方法を確立して再発防止を目的をしている。

基本的に、客先環境について以下 2 ケースに当てはまると想定できる。  
`1. 既存の開発環境で細分化したマイタスクをチケットで管理可能な場合`
`2. チケット管理不可能な場合`
1 の時、状況がチームで共有できるため作成物の必要性は薄い
一方 2 の時、これから作成予定の作成物に習い、進捗と工数管理、質問事項などについてチームまたは業務指示者に認識していただくことを想定している。

- 作成環境
  - Mac OS (Excel for Mac)

## 使い方

以下を想定。

1. タスクシートの[シート作成]ボタンを押下する。
1. 進捗に応じて各タスクの実績部分を着色する。
1. 場合に応じて、タスクシートの[削除]ボタンを押下。(デバッグ用)

実績日数と予定日数の差分を出し差分が
実績 > 予定　で 工数遅れ
実績 < 予定　で 工数達成

## シートについて

シートは以下を想定

- タスクシート
- スケジュールシート

## シートの説明

### タスクシート

#### カラム要素

- マイタスク
- 開始日
- 予定期日
- 達成率
- 完了アイコン
- メモ

いずれもフィルターをかけ、並び替えを可能にする。

###### マイタスク

タスクについて細分化して記述する  
ex) A 機能の開発 => A 機能の実装 => A 機能の B 処理の実装 => B 処理の C メソッドの作成 => B 処理の技術課題調査など

###### 開始日

タスクの開始日(予定も含む)

###### 予定期日

全体タスク(プロジェクト規模)の予定終了日

- 期日が確定している時
  - セルに色をつけて区別する
- 期日が確定していない予定日の時
  - 色は付けない

###### 達成率

進捗度合いを 4 分割(0%,25%,50%,75%,100%)として
プログレスバーで表現する。

###### 完了アイコン

- 達成率カラムの値が 100%の時
  - ● アイコンと完了の文字を表示
- それ以外
  - 何もしない

###### メモ

タスクの詳細や疑問点などを明記する。
長くなる可能性も考慮して

`折り返しで全体表示`
`[書式] -> [行の高さの自動調整]`

##### スケジュールシート作成に用いるパラメータ

現状、以下を想定

- 日数合計
- 最早開始日
- 最長期日
- 最長日数

### スケジュールシート

タスクシートに[**シート作成**]ボタンを作成して、ボタンが押された時
タスクシートを元に、自動でスケジュールシートが作成されることを目指す。

##### 押下後の挙動列挙

1. [**スケジュールシート**]の作成
   1. シート名がスケジュールで作成される。
   1. `[書式] -> [行の高さの自動調整]`
   1. `[書式] -> [列の高さの自動調整]`
1. [**タスク一覧**]の生成(_A1 セル_)
   1. タスクシートの[マイタスク]カラムの要素を参照して奇数行にタスク名を表示する
   1. タスクシートのフィルターに対応させる。
1. [**実績/予定**]の生成(_B1 セル_)
   1. タスク名が空でない時
      1. [**タスク一覧**]の同行タスク名を参照して、[**実績**]と[**予定**]の 2 行を表示する。
      1. 実績はオレンジ色に着色
      1. 予定は黄色に着色
   1. タスク名が空の時
      1. [**実績なし**]、[**予定なし**]と表示する。
   1. 最下行の値を取得しておく。(タスク一覧カラム数 + 1)
1. [**日付**]の作成(_C1 セル〜_)
   1. タスクシートの`最早開始日`を参照して C1 セルに表示する。
   1. タスクシートの`最長日数`まで C1 セルの日付を 1 日ずつインクリメントさせる
      1. D1,E1...とインクリメントした日付を表示する。
      1. 表示した最後の日付がタスクシートの`最長期日`と同じか確認する。
         1. 異なる時、エラ〜メッセージを表示する。(`期日が異なります。`)
1. 実績日数の色付け
   1. タスクシートのマイタスクの要素、[開始日]と[予定期日]を参照して[開始日]から[日数合計]分、実績日数セルを色付けする。
